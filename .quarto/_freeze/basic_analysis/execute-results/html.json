{
  "hash": "97cf8a89bdbf8f8bc896f73ad8eca98c",
  "result": {
    "markdown": "---\ntitle: \"Microbiota Analysis\"\nauthor: Sudarshan A. Shetty\ndate: \"2023-01-07\"\nformat:\n  html:\n    code-tools: true\n    code-fold: false\n    code-copy: true\n    self-contained: true\n    toc-location: left\nknitr: \n    opts_chunk: \n        collapse: TRUE\n        dpi: 150\n        message: FALSE\n        warning: FALSE\n        error: TRUE\neditor: visual\nparams:\n    pseq_path: pseq_path\n    primary_var: primary_var\n---\n\n\n## Load libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(phyloseq)\nlibrary(microbiome)\nlibrary(ggpubr) # stats with viz\nlibrary(patchwork) # combine plots \n```\n:::\n\n\n## Define parameters\n\n\n::: {.cell}\n\n```{.r .cell-code}\npseq_path = params$pseq_path\nprimary_var = params$primary_var\n```\n:::\n\n\n## Read Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\npseq <- readRDS(pseq_path)\n```\n:::\n\n\n## Check Reads\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# add reads/sample to sample_data()\nsample_data(pseq)$reads.per.sample <- sample_sums(pseq)\n# Compare between groups\npseq |> \n    microbiome::meta() |> \n    ggplot(aes_string(primary_var, \"reads.per.sample\")) +\n    geom_violin()+\n    geom_boxplot(width=0.2) +\n    labs(x=\"\", y=\"Reads/sample\")\n```\n\n::: {.cell-output-display}\n![](basic_analysis_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=750}\n:::\n:::\n\n\nNote here that we have higher reads/sample in L2 group.\\\n\n## Alpha diversity\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# we can add shannon diversity to sample_data(pseq)\nsample_data(pseq)$shannon <- microbiome::diversity(pseq, index=\"shannon\")[,1]\nsample_data(pseq)$observed <- microbiome::richness(pseq, index=\"observed\")[,1]\np.shannon <- meta(pseq) |> \n    ggplot(aes_string(primary_var, \"shannon\")) +\n    geom_violin()+\n    geom_boxplot(width=0.2) +\n    labs(x=\"\", y=\"Shannon Diversity\")\np.observed <- meta(pseq) |> \n    ggplot(aes_string(primary_var, \"observed\")) +\n    geom_violin()+\n    geom_boxplot(width=0.2) +\n    labs(x=\"\", y=\"Observed ASVs\")\n\np.shannon | p.observed\n```\n\n::: {.cell-output-display}\n![](basic_analysis_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=1200}\n:::\n:::\n\n\n## Correlation\n\nCheck if reads per sample is correlated to Shannon diversity\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np.shanon.cor <- meta(pseq) |> \n    ggplot(aes_string(\"reads.per.sample\", \"shannon\")) +\n    geom_point() +\n    geom_smooth(method = \"lm\") +\n    ggpubr::stat_cor(method = \"spearman\", label.y = 2)+\n    labs(x=\"Reads/sample\", y=\"Shannon Diversity\")\np.observed.cor <- meta(pseq) |> \n    ggplot(aes_string(\"reads.per.sample\", \"observed\")) +\n    geom_point() +\n    geom_smooth(method = \"lm\") +\n    ggpubr::stat_cor(method = \"spearman\", label.y = 2) +\n    labs(x=\"Reads/sample\", y=\"Observed ASVs\")\n\np.shanon.cor | p.observed.cor\n```\n\n::: {.cell-output-display}\n![](basic_analysis_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=1200}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n## R version 4.2.1 (2022-06-23 ucrt)\n## Platform: x86_64-w64-mingw32/x64 (64-bit)\n## Running under: Windows 10 x64 (build 19044)\n## \n## Matrix products: default\n## \n## locale:\n## [1] LC_COLLATE=English_United States.utf8 \n## [2] LC_CTYPE=English_United States.utf8   \n## [3] LC_MONETARY=English_United States.utf8\n## [4] LC_NUMERIC=C                          \n## [5] LC_TIME=English_United States.utf8    \n## \n## attached base packages:\n## [1] stats     graphics  grDevices utils     datasets  methods   base     \n## \n## other attached packages:\n## [1] patchwork_1.1.2   ggpubr_0.4.0      microbiome_1.18.0 ggplot2_3.3.6    \n## [5] phyloseq_1.40.0  \n## \n## loaded via a namespace (and not attached):\n##  [1] Biobase_2.56.0         tidyr_1.2.0            jsonlite_1.8.0        \n##  [4] splines_4.2.1          foreach_1.5.2          carData_3.0-5         \n##  [7] assertthat_0.2.1       stats4_4.2.1           GenomeInfoDbData_1.2.8\n## [10] yaml_2.3.5             backports_1.4.1        pillar_1.8.1          \n## [13] lattice_0.20-45        glue_1.6.2             digest_0.6.29         \n## [16] XVector_0.36.0         ggsignif_0.6.3         colorspace_2.0-3      \n## [19] htmltools_0.5.3        Matrix_1.5-1           plyr_1.8.7            \n## [22] pkgconfig_2.0.3        broom_1.0.1            zlibbioc_1.42.0       \n## [25] purrr_0.3.4            scales_1.2.1           Rtsne_0.16            \n## [28] tibble_3.1.7           mgcv_1.8-40            farver_2.1.1          \n## [31] car_3.1-0              generics_0.1.3         IRanges_2.30.0        \n## [34] ellipsis_0.3.2         withr_2.5.0            BiocGenerics_0.42.0   \n## [37] cli_3.3.0              survival_3.3-1         magrittr_2.0.3        \n## [40] crayon_1.5.1           evaluate_0.16          fansi_1.0.3           \n## [43] nlme_3.1-157           MASS_7.3-57            rstatix_0.7.0         \n## [46] vegan_2.6-2            tools_4.2.1            data.table_1.14.2     \n## [49] lifecycle_1.0.2        stringr_1.4.1          Rhdf5lib_1.18.2       \n## [52] S4Vectors_0.34.0       munsell_0.5.0          cluster_2.1.3         \n## [55] Biostrings_2.64.0      ade4_1.7-19            compiler_4.2.1        \n## [58] GenomeInfoDb_1.32.2    rlang_1.0.5            rhdf5_2.40.0          \n## [61] grid_4.2.1             RCurl_1.98-1.6         iterators_1.0.14      \n## [64] rhdf5filters_1.8.0     biomformat_1.24.0      rstudioapi_0.14       \n## [67] htmlwidgets_1.5.4      igraph_1.3.1           labeling_0.4.2        \n## [70] bitops_1.0-7           rmarkdown_2.16         gtable_0.3.1          \n## [73] codetools_0.2-18       multtest_2.52.0        abind_1.4-5           \n## [76] DBI_1.1.3              reshape2_1.4.4         R6_2.5.1              \n## [79] knitr_1.40             dplyr_1.0.9            fastmap_1.1.0         \n## [82] utf8_1.2.2             permute_0.9-7          ape_5.6-2             \n## [85] stringi_1.7.6          parallel_4.2.1         Rcpp_1.0.8.3          \n## [88] vctrs_0.4.1            tidyselect_1.1.2       xfun_0.31\n```\n:::\n",
    "supporting": [
      "basic_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}